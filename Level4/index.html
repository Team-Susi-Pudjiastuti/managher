<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ManagHer — Dashboard</title>
<!-- Tailwind -->  
<script src="https://cdn.tailwindcss.com"></script>  
<!--CSS Global-->  
<link rel="stylesheet" href="..\template\style.css" class="css">  
<!--CSS-->  
<link rel="stylesheet" href="style.css" class="css">  
<!-- Script js Global -->   
<script src="..\template\script.js" defer></script>   



</head>
<body class="min-h-screen">
  <!-- SIDEBAR -->
  <aside id="sidebar" class="sidebar fixed top-0 left-0 h-full bg-white border-r shadow-sm p-4 w-64 hidden lg:block">
    <div class="flex items-center gap-3 mb-4">
      <div id="brandLogo" class="w-12 h-12 rounded-xl grad-accent grid place-items-center text-lg font-extrabold shadow-md">MH</div>
      <div class="leading-tight">
        <div class="font-semibold">ManagHer</div>
        <div class="text-xs text-slate-500">Solopreneur Journey</div>
      </div>
    </div>
    <nav class="mt-2">
      <ul class="space-y-1 text-sm">
        <li>
          <a href="../Dashboard/index.html" class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 3h18v4H3V3zM3 10h18v11H3V10z" /></svg>
            <span class="menu-text">Dashboard</span>
          </a>
        </li>
        <li>
          <div>
            <button id="homepageBtn" class="w-full flex items-center justify-between gap-3 p-2 rounded-lg hover:bg-slate-100" onclick="toggleHomepageSubmenu(); toggleMobileSidebar(false)">
              <span class="flex items-center gap-3">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 10l9-7 9 7v9a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-9z"/></svg>
                <span class="menu-text">Homepage</span>
              </span>
              <svg id="homeArrow" class="w-4 h-4 transform transition-transform" viewBox="0 0 20 20"><path d="M6 8l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
            </button>
            <ul id="homepageSubmenu" class="ml-6 mt-2 space-y-1 text-xs">
              <li>
                <button class="w-full text-left p-2 rounded-md hover:bg-slate-100" onclick="goToLevel(1); toggleMobileSidebar(false)">
                  Level 1: Ide Bisnis
                </button>
              </li>
              <li>
                <button class="w-full text-left p-2 rounded-md hover:bg-slate-100" onclick="goToLevel(2); toggleMobileSidebar(false)">
                  Level 2: Validasi Ide
                </button>
              </li>
              <li>
                <button class="w-full text-left p-2 rounded-md hover:bg-slate-100" onclick="goToLevel(3); toggleMobileSidebar(false)">
                  Level 3: Prototype
                </button>
              </li>
              <li>
                <button class="w-full text-left p-2 rounded-md bg-slate-100 hover:bg-slate-100" onclick="goToLevel(4); toggleMobileSidebar(false)">
                  Level 4: Action
                </button>
              </li>
              <li>
                <button class="w-full text-left p-2 rounded-md hover:bg-slate-100" onclick="goToLevel(5); toggleMobileSidebar(false)">
                  Level 5: Business Model Canvas
                </button>
              </li>
            </ul>
          </div>
        </li>
        <li>
          <a href="../Badges/index.html" class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100" onclick="showBadges()">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M12 2l3 7h7l-5.5 4.2L20 23l-8-5-8 5 3.5-9.8L2 9h7l3-7z"/></svg>
            <span class="menu-text">Badges</span>
          </a>
        </li>
        <li>
          <button class="w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100 text-red-600" onclick="logout()">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M17 16l4-4m0 0l-4-4m4 4H7"/></svg>
            <span class="menu-text">Logout</span>
          </button>
        </li>
      </ul>
    </nav>
    <div class="mt-auto pt-4 text-xs text-slate-500">
      <div>v1.0 — Prototype</div>
    </div>
  </aside>
  
  <!-- Mobile Sidebar Toggle -->
  <div class="lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b p-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <button id="mobileMenuBtn" class="p-2 border rounded-lg">
        <svg class="w-5 h-5" viewBox="0 0 24 24">
          <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-xl grad-accent grid place-items-center text-white font-bold">MH</div>
        <div>
          <div class="text-lg font-semibold">ManagHer</div>
          <div class="text-xs text-slate-500">Solopreneur Journey</div>
        </div>
      </div>
    </div>
    <div class="text-xs text-slate-500">Dashboard</div>
  </div>
  

   <!-- MAIN CONTENT -->

  <div id="main" class="lg:ml-64 pt-16 lg:pt-6 p-6">
    <!-- Header -->
    <header class="flex items-start gap-6 mb-6">
      <div class="flex-1">
        <h1 class="text-2xl font-semibold">Level 4: Action</h1>
        <p class="text-sm text-slate-500">Pantau dan analisis performa penjualan Anda</p>
      </div>
      <div class="w-72">
        <div class="flex items-center justify-end gap-3 mb-2">
          <!-- small global progress -->
          <div class="text-xs text-slate-500 mr-2">Progress</div>
          <div class="w-40 bg-slate-100 rounded-full h-3 overflow-hidden">
            <div id="globalBar" class="h-3 rounded-full grad-accent" style="width:100%"></div>
          </div>
          <div id="globalPct" class="text-sm font-medium ml-3">100%</div>
        </div>
      </div>
    </header>
    
    <!-- Top area: Level Info + Tips & Trick -->
    <div class="grid md:grid-cols-3 gap-6 mb-6">
      <!-- Level Info Card -->
      <div class="bg-white rounded-2xl p-6 card-hover border border-slate-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">🎁</span>
          <div class="text-xs text-pink-500 font-semibold">Level Info</div>
        </div>
        <h2 class="text-lg font-bold mt-1">Level 4: Action</h2>
        <div class="text-sm text-slate-600 mt-1">🏆 Badge "Boss Lady"</div>
        <div class="mt-3 text-sm text-slate-700">🎁 Output: Mini Dashboard Performa Penjualan Marketing dan Finance</div>
        
        <!-- Navigation buttons -->
        <div class="flex justify-between mt-6 pt-4 border-t">
          <button class="px-4 py-2 text-sm rounded-lg grad-accent hover:opacity-90">
            ← Prev
          </button>
           <button class="px-4 py-2 text-sm rounded-lg grad-accent hover:opacity-90">
            Next →
          </button>
        </div>
      </div>
      
      <!-- Tips & Trick Card -->
      <div class="md:col-span-2 bg-white rounded-2xl p-6 card-hover border border-slate-100">
        <div class="flex justify-between items-start mb-4">
          <div>
            <h3 class="text-lg font-semibold">💡 Tips & Trick</h3>
            <p class="text-sm text-slate-500 mt-1">Tips untuk memantau performa penjualan Anda</p>
          </div>
          <div class="text-xs text-slate-400">Level 4</div>
        </div>
        <ul class="mt-4 space-y-3">
          <li class="flex items-start gap-3">
            <span class="text-pink-500 mt-1">📊</span>
            <span class="text-sm">Catat semua pemasukan & pengeluaran harian secara konsisten.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-blue-500 mt-1">💰</span>
            <span class="text-sm">Bandingkan biaya promosi vs penjualan untuk mengetahui efektivitas iklan Anda.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-green-500 mt-1">📈</span>
            <span class="text-sm">Coba variasi posting untuk melihat engagement yang lebih tinggi.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-purple-500 mt-1">🧮</span>
            <span class="text-sm">Kalkulasi profit sederhana tiap hari untuk memantau kesehatan bisnis Anda.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-orange-500 mt-1">🔄</span>
            <span class="text-sm">Gunakan data untuk optimasi campaign berikutnya - fokus pada yang memberikan hasil terbaik.</span>
          </li>
        </ul>
      </div>
    </div>
    
    <!-- Sales Monitoring Form -->
    <div class="bg-white rounded-2xl p-6 border border-slate-100 mb-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold">📋 Form Pantau Hasil Penjualan</h3>
        <div class="flex gap-2">
          <button id="btnReset" class="px-3 py-1.5 text-sm rounded-lg bg-slate-200 hover:bg-slate-300 action-btn">
            🔄 Reset
          </button>
          <button id="btnEdit" class="px-3 py-1.5 text-sm rounded-lg bg-blue-100 hover:bg-blue-200 text-blue-700 action-btn">
            ✏️ Edit
          </button>
          <button id="btnSave" class="px-3 py-1.5 text-sm rounded-lg grad-accent text-white action-btn">
            💾 Simpan
          </button>
        </div>
      </div>
      
      <div class="grid md:grid-cols-2 gap-6">
        <!-- Marketing Data -->
        <div>
          <h4 class="text-lg font-semibold mb-4">📊 Data Marketing</h4>
          <div class="space-y-4">
            <!-- Tanggal -->
            <div>
              <label class="text-sm font-medium mb-2 block">Tanggal</label>
              <input type="date" id="tanggal" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-300" value="2024-01-15">
            </div>
            
            <!-- Platform -->
            <div>
              <label class="text-sm font-medium mb-2 block">Platform</label>
              <select id="platform" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-300">
                <option value="">Pilih platform...</option>
                <option value="Instagram">Instagram</option>
                <option value="TikTok">TikTok</option>
                <option value="WhatsApp">WhatsApp</option>
                <option value="Marketplace">Marketplace (Shopee/Tokopedia)</option>
                <option value="Offline">Offline (Pasar/Pop-up)</option>
              </select>
            </div>
            
            <!-- Biaya Promosi -->
            <div>
              <label class="text-sm font-medium mb-2 block">Biaya Promosi (Rp)</label>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500">Rp</span>
                <input type="number" id="biayaPromosi" class="w-full p-3 pl-10 border rounded-lg focus:ring-2 focus:ring-purple-300" placeholder="200000" value="200000">
              </div>
            </div>
            
            <!-- Engagement Metrics -->
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="text-sm font-medium mb-2 block">Like</label>
                <input type="number" id="likes" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="120" value="120">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">Komentar</label>
                <input type="number" id="comments" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="12" value="12">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">Share</label>
                <input type="number" id="share" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="3" value="3">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">Save</label>
                <input type="number" id="save" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="20" value="20">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">Follower</label>
                <input type="number" id="follower" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="5" value="5">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">DM/Chat</label>
                <input type="number" id="dm" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="10" value="10">
              </div>
            </div>
            
            <!-- Reach & Impression -->
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="text-sm font-medium mb-2 block">Reach</label>
                <input type="number" id="reach" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-300" placeholder="1000" value="1000">
              </div>
              <div>
                <label class="text-sm font-medium mb-2 block">Impression</label>
                <input type="number" id="impression" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-red-300" placeholder="1200" value="1200">
              </div>
            </div>
          </div>
        </div>
        
        <!-- Finance Data -->
        <div>
          <h4 class="text-lg font-semibold mb-4">💰 Data Keuangan</h4>
          <div class="space-y-4">
            <!-- Jumlah Produk Terjual -->
            <div>
              <label class="text-sm font-medium mb-2 block">Jumlah Produk Terjual</label>
              <input type="number" id="jumlahTerjual" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-300" placeholder="15" value="15">
            </div>
            
            <!-- Harga Jual -->
            <div>
              <label class="text-sm font-medium mb-2 block">Harga Jual per Produk (Rp)</label>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500">Rp</span>
                <input type="number" id="hargaJual" class="w-full p-3 pl-10 border rounded-lg focus:ring-2 focus:ring-green-300" placeholder="50000" value="50000">
              </div>
            </div>
            
            <!-- Biaya Bahan Baku -->
            <div>
              <label class="text-sm font-medium mb-2 block">Biaya Bahan Baku (Rp)</label>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500">Rp</span>
                <input type="number" id="biayaBahan" class="w-full p-3 pl-10 border rounded-lg focus:ring-2 focus:ring-purple-300" placeholder="40000" value="40000">
              </div>
            </div>
            
            <!-- Biaya Operasional -->
            <div>
              <label class="text-sm font-medium mb-2 block">Biaya Operasional (Rp)</label>
              <div class="relative">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500">Rp</span>
                <input type="number" id="biayaOperasional" class="w-full p-3 pl-10 border rounded-lg focus:ring-2 focus:ring-purple-300" placeholder="20000" value="20000">
              </div>
            </div>
            
            <!-- Aktivitas -->
            <div>
              <label class="text-sm font-medium mb-2 block">Aktivitas Khusus</label>
              <input type="text" id="aktivitas" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-300" placeholder="Flash Sale, Giveaway, dll" value="Promo Akhir Tahun">
            </div>
            
            <!-- Notes -->
            <div>
              <label class="text-sm font-medium mb-2 block">Catatan Tambahan</label>
              <textarea id="catatan" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-slate-300" rows="3" placeholder="Catatan khusus tentang penjualan hari ini...">Penjualan meningkat karena promo akhir tahun</textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sales Data Table -->
    <div class="bg-white rounded-2xl p-6 border border-slate-100 mb-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-semibold">📋 Tabel Data Penjualan</h3>
        <div class="flex gap-2">
          <button id="btnAddData" class="px-3 py-1.5 text-sm rounded-lg grad-accent text-white action-btn">
            ➕ Tambah Data
          </button>
        </div>
      </div>
      
      <div class="overflow-x-auto">
        <table class="w-full text-sm border-collapse">
          <thead class="bg-slate-50">
            <tr>
              <th class="px-3 py-2 border text-left">Tanggal</th>
              <th class="px-3 py-2 border text-left">Platform</th>
              <th class="px-3 py-2 border text-left">Terjual</th>
              <th class="px-3 py-2 border text-left">Revenue</th>
              <th class="px-3 py-2 border text-left">Biaya</th>
              <th class="px-3 py-2 border text-left">Profit</th>
              <th class="px-3 py-2 border text-left">ROI</th>
              <th class="px-3 py-2 border text-left">Aksi</th>
            </tr>
          </thead>
          <tbody id="salesTableBody">
            <!-- Data will be populated here -->
          </tbody>
        </table>
      </div>
      
      <div class="mt-4 text-sm text-slate-500">
        Total data penjualan: <span id="totalSalesCount">0</span> | Total revenue: <span id="totalRevenue">Rp 0</span>
      </div>
    </div>
    
    <!-- Performance Dashboard -->
    <div class="bg-white rounded-2xl p-6 border border-slate-100">
      <h3 class="text-xl font-semibold mb-6">📈 Dashboard Performa Penjualan</h3>
      
      <!-- Key Metrics -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- ROI -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">ROI (Return on Investment)</div>
          <div class="text-2xl font-bold" id="metricROI">250%</div>
          <div class="text-xs text-green-600">↑ 15% dari periode sebelumnya</div>
        </div>
        
        <!-- Engagement Rate -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Engagement Rate</div>
          <div class="text-2xl font-bold" id="metricEngagementRate">15.8%</div>
          <div class="text-xs text-green-600">↑ 3.2% dari periode sebelumnya</div>
        </div>
        
        <!-- Conversion Rate -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Conversion Rate</div>
          <div class="text-2xl font-bold" id="metricConversionRate">2.5%</div>
          <div class="text-xs text-orange-600">↓ 0.3% dari periode sebelumnya</div>
        </div>
        
        <!-- Profit Margin -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Profit Margin</div>
          <div class="text-2xl font-bold" id="metricProfitMargin">60%</div>
          <div class="text-xs text-green-600">↑ 8% dari periode sebelumnya</div>
        </div>
      </div>
      
      <!-- Financial Metrics -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Jumlah Produk Terjual -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Jumlah Produk Terjual</div>
          <div class="text-2xl font-bold" id="metricJumlahTerjual">75</div>
          <div class="text-xs text-green-600">↑ 12 dari periode sebelumnya</div>
        </div>
        
        <!-- Total Revenue -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Total Revenue</div>
          <div class="text-2xl font-bold" id="metricTotalRevenue">Rp 3.750.000</div>
          <div class="text-xs text-green-600">↑ Rp 600.000 dari periode sebelumnya</div>
        </div>
        
        <!-- Total Biaya -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Total Biaya</div>
          <div class="text-2xl font-bold" id="metricTotalBiaya">Rp 1.500.000</div>
          <div class="text-xs text-red-600">↑ Rp 200.000 dari periode sebelumnya</div>
        </div>
        
        <!-- Net Profit -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Net Profit</div>
          <div class="text-2xl font-bold" id="metricNetProfit">Rp 2.250.000</div>
          <div class="text-xs text-green-600">↑ Rp 400.000 dari periode sebelumnya</div>
        </div>
      </div>
      
      <!-- Advanced Metrics -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Gross Profit -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Gross Profit</div>
          <div class="text-2xl font-bold" id="metricGrossProfit">Rp 3.150.000</div>
          <div class="text-xs text-green-600">↑ Rp 500.000 dari periode sebelumnya</div>
        </div>
        
        <!-- Break Even Point -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Break Even Point (BEP)</div>
          <div class="text-2xl font-bold" id="metricBEP">20 unit</div>
          <div class="text-xs text-green-600">↓ 3 unit dari periode sebelumnya</div>
        </div>
        
        <!-- Conversion Rate Sales -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Conversion Rate Sales</div>
          <div class="text-2xl font-bold" id="metricConversionRateSales">1.25%</div>
          <div class="text-xs text-orange-600">↓ 0.15% dari periode sebelumnya</div>
        </div>
        
        <!-- Cost per Acquisition -->
        <div class="metric-card">
          <div class="text-xs text-slate-500 mb-1">Cost per Acquisition</div>
          <div class="text-2xl font-bold" id="metricCPA">Rp 20.000</div>
          <div class="text-xs text-red-600">↑ Rp 2.500 dari periode sebelumnya</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    
// Initialize data
let salesData = [
  { 
    id: 1, 
    tanggal: "2024-01-15", 
    platform: "Instagram", 
    aktivitas: "Promo Akhir Tahun",
    biayaPromosi: 200000,
    jumlahTerjual: 15,
    likes: 120,
    comments: 12,
    share: 3,
    save: 20,
    follower: 5,
    dm: 10,
    reach: 1000,
    impression: 1200,
    biayaBahan: 40000,
    biayaOperasional: 20000,
    hargaJual: 50000,
    catatan: "Penjualan meningkat karena promo akhir tahun",
    savedAt: new Date().toISOString()
  },
  { 
    id: 2, 
    tanggal: "2024-01-14", 
    platform: "TikTok", 
    aktivitas: "Giveaway",
    biayaPromosi: 150000,
    jumlahTerjual: 12,
    likes: 200,
    comments: 25,
    share: 8,
    save: 35,
    follower: 8,
    dm: 15,
    reach: 1500,
    impression: 1800,
    biayaBahan: 35000,
    biayaOperasional: 15000,
    hargaJual: 50000,
    catatan: "Giveaway berhasil menarik banyak engagement",
    savedAt: new Date().toISOString()
  },
  { 
    id: 3, 
    tanggal: "2024-01-13", 
    platform: "Marketplace", 
    aktivitas: "Flash Sale",
    biayaPromosi: 100000,
    jumlahTerjual: 20,
    likes: 80,
    comments: 8,
    share: 2,
    save: 15,
    follower: 3,
    dm: 5,
    reach: 800,
    impression: 950,
    biayaBahan: 45000,
    biayaOperasional: 25000,
    hargaJual: 45000,
    catatan: "Flash sale sangat efektif untuk meningkatkan penjualan",
    savedAt: new Date().toISOString()
  },
  { 
    id: 4, 
    tanggal: "2024-01-12", 
    platform: "Instagram", 
    aktivitas: "Posting Biasa",
    biayaPromosi: 50000,
    jumlahTerjual: 8,
    likes: 90,
    comments: 10,
    share: 1,
    save: 12,
    follower: 2,
    dm: 8,
    reach: 900,
    impression: 1100,
    biayaBahan: 30000,
    biayaOperasional: 15000,
    hargaJual: 55000,
    catatan: "Performa normal tanpa promo khusus",
    savedAt: new Date().toISOString()
  },
  { 
    id: 5, 
    tanggal: "2024-01-11", 
    platform: "WhatsApp", 
    aktivitas: "Broadcast ke Pelanggan",
    biayaPromosi: 0,
    jumlahTerjual: 10,
    likes: 0,
    comments: 0,
    share: 0,
    save: 0,
    follower: 0,
    dm: 20,
    reach: 200,
    impression: 200,
    biayaBahan: 35000,
    biayaOperasional: 10000,
    hargaJual: 50000,
    catatan: "Broadcast ke pelanggan lama cukup efektif",
    savedAt: new Date().toISOString()
  }
];

// Chart objects
const chartPool = {};

// DOM Elements
const tanggalInput = document.getElementById('tanggal');
const platformSelect = document.getElementById('platform');
const biayaPromosiInput = document.getElementById('biayaPromosi');
const jumlahTerjualInput = document.getElementById('jumlahTerjual');
const likesInput = document.getElementById('likes');
const commentsInput = document.getElementById('comments');
const shareInput = document.getElementById('share');
const saveInput = document.getElementById('save');
const followerInput = document.getElementById('follower');
const dmInput = document.getElementById('dm');
const reachInput = document.getElementById('reach');
const impressionInput = document.getElementById('impression');
const biayaBahanInput = document.getElementById('biayaBahan');
const biayaOperasionalInput = document.getElementById('biayaOperasional');
const hargaJualInput = document.getElementById('hargaJual');
const aktivitasInput = document.getElementById('aktivitas');
const catatanTextarea = document.getElementById('catatan');

const salesTableBody = document.getElementById('salesTableBody');
const totalSalesCount = document.getElementById('totalSalesCount');
const totalRevenue = document.getElementById('totalRevenue');

const metricROI = document.getElementById('metricROI');
const metricEngagementRate = document.getElementById('metricEngagementRate');
const metricConversionRate = document.getElementById('metricConversionRate');
const metricProfitMargin = document.getElementById('metricProfitMargin');
const metricJumlahTerjual = document.getElementById('metricJumlahTerjual');
const metricTotalRevenue = document.getElementById('metricTotalRevenue');
const metricTotalBiaya = document.getElementById('metricTotalBiaya');
const metricNetProfit = document.getElementById('metricNetProfit');
const metricGrossProfit = document.getElementById('metricGrossProfit');
const metricBEP = document.getElementById('metricBEP');
const metricConversionRateSales = document.getElementById('metricConversionRateSales');
const metricCPA = document.getElementById('metricCPA');

const btnReset = document.getElementById('btnReset');
const btnEdit = document.getElementById('btnEdit');
const btnSave = document.getElementById('btnSave');
const btnAddData = document.getElementById('btnAddData');
const mobileMenuBtn = document.getElementById('mobileMenuBtn');

// Calculate metrics
function calculateMetrics() {
  let totalRevenueVal = 0;
  let totalCostVal = 0;
  let totalGrossProfitVal = 0;
  let totalNetProfitVal = 0;
  let totalAdsCostVal = 0;
  let totalItemsSoldVal = 0;
  let totalReachVal = 0;
  let totalImpressionVal = 0;
  let totalEngagementVal = 0;
  
  salesData.forEach(item => {
    const revenue = item.jumlahTerjual * item.hargaJual;
    const costOfGoods = item.jumlahTerjual * item.biayaBahan;
    const totalCost = costOfGoods + item.biayaOperasional + item.biayaPromosi;
    const grossProfit = revenue - costOfGoods;
    const netProfit = revenue - totalCost;
    
    totalRevenueVal += revenue;
    totalCostVal += totalCost;
    totalGrossProfitVal += grossProfit;
    totalNetProfitVal += netProfit;
    totalAdsCostVal += item.biayaPromosi;
    totalItemsSoldVal += item.jumlahTerjual;
    totalReachVal += item.reach;
    totalImpressionVal += item.impression;
    totalEngagementVal += item.likes + item.comments + item.share + item.save;
  });
  
  // Update metrics
  const roi = totalAdsCostVal > 0 ? ((totalNetProfitVal / totalAdsCostVal) * 100).toFixed(1) : 0;
  const engagementRate = totalReachVal > 0 ? ((totalEngagementVal / totalReachVal) * 100).toFixed(1) : 0;
  const conversionRate = totalImpressionVal > 0 ? ((totalItemsSoldVal / totalImpressionVal) * 100).toFixed(2) : 0;
  const profitMargin = totalRevenueVal > 0 ? ((totalNetProfitVal / totalRevenueVal) * 100).toFixed(1) : 0;
  const conversionRateSales = totalReachVal > 0 ? ((totalItemsSoldVal / totalReachVal) * 100).toFixed(2) : 0;
  const bep = (totalCostVal / (hargaJualInput.value || 50000)).toFixed(0);
  const cpa = totalItemsSoldVal > 0 ? (totalAdsCostVal / totalItemsSoldVal).toFixed(0) : 0;
  
  // Format currency
  const formatCurrency = (value) => `Rp ${value.toLocaleString()}`;
  
  // Update DOM
  metricROI.textContent = `${roi}%`;
  metricEngagementRate.textContent = `${engagementRate}%`;
  metricConversionRate.textContent = `${conversionRate}%`;
  metricProfitMargin.textContent = `${profitMargin}%`;
  metricJumlahTerjual.textContent = totalItemsSoldVal;
  metricTotalRevenue.textContent = formatCurrency(totalRevenueVal);
  metricTotalBiaya.textContent = formatCurrency(totalCostVal);
  metricNetProfit.textContent = formatCurrency(totalNetProfitVal);
  metricGrossProfit.textContent = formatCurrency(totalGrossProfitVal);
  metricBEP.textContent = `${bep} unit`;
  metricConversionRateSales.textContent = `${conversionRateSales}%`;
  metricCPA.textContent = `Rp ${cpa}`;
  
  // Update summary
  totalSalesCount.textContent = salesData.length;
  totalRevenue.textContent = formatCurrency(totalRevenueVal);
}

// Render sales table
function renderSalesTable() {
  salesTableBody.innerHTML = '';
  
  salesData.forEach(item => {
    const revenue = item.jumlahTerjual * item.hargaJual;
    const costOfGoods = item.jumlahTerjual * item.biayaBahan;
    const totalCost = costOfGoods + item.biayaOperasional + item.biayaPromosi;
    const netProfit = revenue - totalCost;
    const roi = item.biayaPromosi > 0 ? ((netProfit / item.biayaPromosi) * 100).toFixed(1) : 0;
    
    const row = document.createElement('tr');
    row.className = 'hover:bg-slate-50';
    row.innerHTML = `
      <td class="px-3 py-2 border">${item.tanggal}</td>
      <td class="px-3 py-2 border">${item.platform}</td>
      <td class="px-3 py-2 border text-center">${item.jumlahTerjual}</td>
      <td class="px-3 py-2 border text-right">Rp ${revenue.toLocaleString()}</td>
      <td class="px-3 py-2 border text-right">Rp ${totalCost.toLocaleString()}</td>
      <td class="px-3 py-2 border text-right ${netProfit >= 0 ? 'text-green-600' : 'text-red-600'}">Rp ${netProfit.toLocaleString()}</td>
      <td class="px-3 py-2 border text-right">${roi}%</td>
      <td class="px-3 py-2 border text-center">
        <div class="flex gap-1 justify-center">
          <button class="text-blue-600 hover:text-blue-800 text-xs p-1 edit-btn" data-id="${item.id}">✏️</button>
          <button class="text-red-600 hover:text-red-800 text-xs p-1 delete-btn" data-id="${item.id}">🗑️</button>
        </div>
      </td>
    `;
    salesTableBody.appendChild(row);
  });
  
  // Calculate and update metrics
  calculateMetrics();
}

// Button event listeners
btnReset.addEventListener('click', function() {
  if(confirm("Apakah Anda yakin ingin mereset form ini?")) {
    tanggalInput.value = "";
    platformSelect.selectedIndex = 0;
    biayaPromosiInput.value = "";
    jumlahTerjualInput.value = "";
    likesInput.value = "";
    commentsInput.value = "";
    shareInput.value = "";
    saveInput.value = "";
    followerInput.value = "";
    dmInput.value = "";
    reachInput.value = "";
    impressionInput.value = "";
    biayaBahanInput.value = "";
    biayaOperasionalInput.value = "";
    hargaJualInput.value = "";
    aktivitasInput.value = "";
    catatanTextarea.value = "";
  }
});

btnEdit.addEventListener('click', function() {
  alert("Mode edit diaktifkan. Anda dapat mengubah data pada form.");
});

btnSave.addEventListener('click', function() {
  // Validate required fields
  if(!tanggalInput.value || !platformSelect.value || !jumlahTerjualInput.value || !hargaJualInput.value) {
    alert("Mohon lengkapi field yang wajib diisi (Tanggal, Platform, Jumlah Terjual, Harga Jual)!");
    return;
  }
  
  // Create new sales object
  const newSale = {
    id: Date.now(), // Simple unique ID
    tanggal: tanggalInput.value,
    platform: platformSelect.value,
    aktivitas: aktivitasInput.value || "-",
    biayaPromosi: parseInt(biayaPromosiInput.value) || 0,
    jumlahTerjual: parseInt(jumlahTerjualInput.value),
    likes: parseInt(likesInput.value) || 0,
    comments: parseInt(commentsInput.value) || 0,
    share: parseInt(shareInput.value) || 0,
    save: parseInt(saveInput.value) || 0,
    follower: parseInt(followerInput.value) || 0,
    dm: parseInt(dmInput.value) || 0,
    reach: parseInt(reachInput.value) || 0,
    impression: parseInt(impressionInput.value) || 0,
    biayaBahan: parseInt(biayaBahanInput.value) || 0,
    biayaOperasional: parseInt(biayaOperasionalInput.value) || 0,
    hargaJual: parseInt(hargaJualInput.value),
    catatan: catatanTextarea.value || "-",
    savedAt: new Date().toISOString()
  };
  
  // Add to array
  salesData.push(newSale);
  
  // Update UI
  renderSalesTable();
  
  // Reset form (optional - you can comment this out if you want to keep the data)
  // tanggalInput.value = "";
  // platformSelect.selectedIndex = 0;
  // biayaPromosiInput.value = "";
  // jumlahTerjualInput.value = "";
  // likesInput.value = "";
  // commentsInput.value = "";
  // shareInput.value = "";
  // saveInput.value = "";
  // followerInput.value = "";
  // dmInput.value = "";
  // reachInput.value = "";
  // impressionInput.value = "";
  // biayaBahanInput.value = "";
  // biayaOperasionalInput.value = "";
  // hargaJualInput.value = "";
  // aktivitasInput.value = "";
  // catatanTextarea.value = "";
  
  alert("Data penjualan berhasil disimpan! 🎉");
});

btnAddData.addEventListener('click', function() {
  btnSave.click();
});

// Event delegation for edit and delete buttons in table
salesTableBody.addEventListener('click', function(e) {
  if(e.target.classList.contains('edit-btn')) {
    const id = parseInt(e.target.dataset.id);
    const item = salesData.find(x => x.id === id);
    
    if(item) {
      tanggalInput.value = item.tanggal;
      platformSelect.value = item.platform;
      biayaPromosiInput.value = item.biayaPromosi;
      jumlahTerjualInput.value = item.jumlahTerjual;
      likesInput.value = item.likes;
      commentsInput.value = item.comments;
      shareInput.value = item.share;
      saveInput.value = item.save;
      followerInput.value = item.follower;
      dmInput.value = item.dm;
      reachInput.value = item.reach;
      impressionInput.value = item.impression;
      biayaBahanInput.value = item.biayaBahan;
      biayaOperasionalInput.value = item.biayaOperasional;
      hargaJualInput.value = item.hargaJual;
      aktivitasInput.value = item.aktivitas;
      catatanTextarea.value = item.catatan;
      
      // Scroll to form
      document.querySelector('.bg-white.rounded-2xl.p-6.border.border-slate-100').scrollIntoView({ behavior: 'smooth' });
      
      alert("Data telah dimuat ke form. Silakan edit dan simpan kembali.");
    }
  }
  
  if(e.target.classList.contains('delete-btn')) {
    if(confirm("Apakah Anda yakin ingin menghapus data penjualan ini?")) {
      const id = parseInt(e.target.dataset.id);
      salesData = salesData.filter(x => x.id !== id);
      
      renderSalesTable();
      
      alert("Data penjualan berhasil dihapus!");
    }
  }
});

// Mobile menu toggle
mobileMenuBtn.addEventListener('click', function() {
  const sidebar = document.getElementById('sidebar');
  if(sidebar.classList.contains('hidden')) {
    sidebar.classList.remove('hidden');
    sidebar.classList.add('fixed', 'top-16', 'left-0', 'right-0', 'bottom-0', 'z-40', 'shadow-lg');
  } else {
    sidebar.classList.add('hidden');
    sidebar.classList.remove('fixed', 'top-16', 'left-0', 'right-0', 'bottom-0', 'z-40', 'shadow-lg');
  }
});

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  renderSalesTable();
  
  // Set initial progress
  const globalBar = document.getElementById('globalBar');
  const globalPct = document.getElementById('globalPct');
  globalBar.style.width = '100%';
  globalPct.textContent = '100%';
});

  </script></body>
</html>